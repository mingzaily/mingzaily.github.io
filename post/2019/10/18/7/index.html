<!DOCTYPE html>
<html lang="zh-CN">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>计算机网络 - 星河</title>
    <meta property="og:title" content="计算机网络 - 星河">
    
    <meta name="twitter:card" content="summary">

    
    
      
    

    
      
      <meta property="description" content="TCP/IP 又叫网际协议群，可以说是 OSI 模型的实现，强调在计算机上实现协议应该开发哪种程序
[&hellip;] TCP Tags
[&hellip;] 一般由客户端发起连接请求
[&hellip;] TCP 使用滑动窗口做流量控制与乱序重排
[&hellip;] SSL（TLS） 安全套接层
">
      <meta property="og:description" content="TCP/IP 又叫网际协议群，可以说是 OSI 模型的实现，强调在计算机上实现协议应该开发哪种程序
[&hellip;] TCP Tags
[&hellip;] 一般由客户端发起连接请求
[&hellip;] TCP 使用滑动窗口做流量控制与乱序重排
[&hellip;] SSL（TLS） 安全套接层
">
      
    

    
    
    

    

    
    

    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>
  <body class="post">
    <header class="masthead">
      <h1><a href="/">星河</a></h1>

<p class="tagline">醉后不知天在水，满船清梦压星河</p>

      <nav class="menu">
  <input id="menu-check" type="checkbox" hidden/>
  <label id="menu-label" for="menu-check" class="unselectable" hidden>
    <span class="icon close-icon">✕</span>
    <span class="icon open-icon">☰</span>
    <span class="text">Menu</span>
  </label>
  <ul>
  
  
  <li><a href="/">首页</a></li>
  
  <li><a href="/shuoshuo">说说</a></li>
  
  <li><a href="/categories/">分类</a></li>
  
  <li><a href="/tags/">标签</a></li>
  
  <li><a href="/about/">关于</a></li>
  
  
  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>计算机网络</h1>



<h3>

mingzaily






 / 
2019-10-18
</h3>

<hr>


      </header>





<h2 id="网络基础">网络基础</h2>
<h3 id="osi-模型">OSI 模型</h3>
<h4 id="表格">表格</h4>
<table>
  <thead>
      <tr>
          <th>概念层</th>
          <th>数据单位</th>
          <th>作用</th>
          <th>设备</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>物理层</td>
          <td>比特</td>
          <td>提供光纤标准、传送数据的通路，传输比特流</td>
          <td>网线等等</td>
      </tr>
      <tr>
          <td>数据链路层</td>
          <td>数据帧</td>
          <td>帧定界和帧同步;顺序控制，指对帧的收发顺序的控制；差错检测和恢复；APR、RARP 协议</td>
          <td>交互机、网桥</td>
      </tr>
      <tr>
          <td>网络层</td>
          <td>数据分组或数据包</td>
          <td>两个主机系统之间提供连接和路径选择</td>
          <td>路由器</td>
      </tr>
      <tr>
          <td>传输层</td>
          <td>报文段</td>
          <td>定义传输协议和端口；分段传输，到达目的地址后重组</td>
          <td>-</td>
      </tr>
      <tr>
          <td>会话层</td>
          <td>-</td>
          <td>管理应用程序间的通信</td>
          <td>-</td>
      </tr>
      <tr>
          <td>表示层</td>
          <td>-</td>
          <td>把应用层提供的信息变换为能够共同理解的形式、保证各系统、应用可以读取</td>
          <td>-</td>
      </tr>
      <tr>
          <td>应用层</td>
          <td>-</td>
          <td>应用层协议，如 HTTP 协议</td>
          <td>-</td>
      </tr>
  </tbody>
</table>
<h4 id="总结">总结</h4>
<ul>
<li>下面 4 层（物理层、数据链路层、网络层和传输层）主要提供数据传输和交换功能，即以节点到节点之间的通信为主；</li>
<li>第 4 层(传输成 TCP/UDP)作为上下两部分的桥梁，是整个网络体系结构中最关键的部分；</li>
<li>简言之，下 4 层主要完成通信子网的功能，上 3 层主要完成资源子网的功能。</li>
</ul>
<h3 id="tcpip-四层模型">TCP/IP 四层模型</h3>
<p>TCP/IP 又叫网际协议群，可以说是 OSI 模型的实现，强调在计算机上实现协议应该开发哪种程序</p>
<table>
  <thead>
      <tr>
          <th>概念层</th>
          <th>TCP/IP 协议群</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>应用层</td>
          <td>FTP、HTTP、Telnt</td>
      </tr>
      <tr>
          <td>数据链路层</td>
          <td>TCP、UDP</td>
      </tr>
      <tr>
          <td>网络层</td>
          <td>IP、ICMP、RIP、OSFF，ICMP，BGF</td>
      </tr>
      <tr>
          <td>网络接口层/链路层</td>
          <td>ISO、IEEE 标准</td>
      </tr>
  </tbody>
</table>
<h2 id="tcp-三次握手四次挥手">TCP 三次握手&amp;四次挥手</h2>
<h3 id="报文格式">报文格式</h3>
<p>TCP Tags</p>
<ul>
<li>URF 紧急指针标志</li>
<li>ACK 确认序号标志</li>
<li>PSH push 标志</li>
<li>RST 重置连接标志</li>
<li>SYN 同步需要，用于建立连接过程</li>
<li>FIN 完成标志，用于释放连接</li>
</ul>
<h3 id="三次握手">三次握手</h3>
<h4 id="具体过程">具体过程</h4>
<p>一般由客户端发起连接请求</p>
<ul>
<li>第一次握手(SYN=1, seq=x)<br>
客户端发送一个 TCP 的 SYN 标志位置 1 的包。<br>
发送完毕后，客户端进入 <code>SYN_SEND</code> 状态。</li>
<li>第二次握手(SYN=1, ACK=1, seq=y, ack=x+1)<br>
服务器发回确认包(ACK)应答。SYN 标志位和 ACK 标志位均为 1。<br>
发送完毕后，服务器端进入 <code>SYN_RCVD</code> 状态。</li>
<li>第三次握手(ACK=1，seq=x+1，ack=y+1)<br>
客户端再次发送确认包(ACK)。SYN 标志位为 0，ACK 标志位为 1<br>
发送完毕后，客户端进入 <code>ESTABLISHED</code> 状态，当服务器端接收到这个包时，也进入 <code>ESTABLISHED</code> 状态，TCP 握手结束。</li>
</ul>
<h4 id="为什么需要三次握手才能建立起连接">为什么需要三次握手才能建立起连接</h4>
<ul>
<li>为了初始化 seq number,作为以后数据传输的序号，保证数据传输过程中数据不会乱序</li>
</ul>
<h4 id="首次握手隐患-syn-超时">首次握手隐患-SYN 超时</h4>
<ul>
<li>Server 收到 Client 的 SYN，回复 SYN-ACK 的时候未收到 ACK</li>
<li>Server 不断重试直至超时</li>
<li>攻击者可以把 SYN 的队列耗尽，使正常请求无法处理</li>
<li>SYN Flood 防护措施
<ul>
<li>SYN 队列满后，通过 tcp_syncookies 参数回发 SYn Cookie</li>
<li>若为正常连接则 Cliet 会回发 SYNCookie，直接建立连接</li>
</ul>
</li>
</ul>
<h4 id="建立连接后client-出现故障">建立连接后，Client 出现故障</h4>
<ul>
<li>向对方发送保活探测报文，如果未收到响应则继续发送，直到保活探测数</li>
</ul>
<h3 id="四次挥手">四次挥手</h3>
<h4 id="具体过程-1">具体过程</h4>
<ul>
<li>第一次挥手(FIN=1，seq=u)<br>
Client 发送一个 FIN 包，迎来关闭 Client 到 Server 的数据传送。<br>
发送完毕后，客户端进入 <code>FIN_WAIT_1</code> 状态。</li>
<li>第二次挥手(ACK=1，seq=v，ack=u+1)<br>
Server 收到 FIN 包，发送一个 ACK 到 Client，确认序号为收到序号+1。<br>
发送完毕后，服务器端进入 <code>CLOSE_WAIT</code> 状态。<br>
客户端接收到这个确认包之后，进入 <code>FIN_WAIT_2</code> 状态，等待服务器端关闭连接。</li>
<li>第三次挥手(FIN=1，ACK=1，seq=w，ack=u+1)<br>
Server 发送一个 FIN 包，用来关闭 Server 到 Client 的数据传送。<br>
发送完毕后，服务器端进入 <code>LAST_ACK</code> 状态，等待来自客户端的最后一个 ACK。</li>
<li>第四次挥手(ACK=1，seq=u+1，ack=w+1)<br>
Client 收到 FIN 包后，Client 进入 <code>TIME_WAIT</code>状态，接着发送一个 ACK 包给 Server，确认序号为收到序号+1。<br>
服务器端接收到这个确认包之后，关闭连接，进入 <code>CLOSED</code> 状态。</li>
<li>客户端等待了某个固定时间（两个最大段生命周期，2MSL，2 Maximum Segment Lifetime）之后，没有收到服务器端的 ACK ，认为服务器端已经正常关闭连接，于是自己也关闭连接，进入 <code>CLOSED</code> 状态。在等待过程中，可以使本连接持续的时间内所产生的所有报文段从网络中消失。这样就可以使下一个新的连接中不会出现旧的连接请求报文段。</li>
</ul>
<h4 id="为什么需要四次握手才能断开连接">为什么需要四次握手才能断开连接</h4>
<ul>
<li>因为全双工，发送发和接收方都需要 FIN 报文和 ACK 报文</li>
</ul>
<h4 id="服务器出现大量-close_wait-状态的原因">服务器出现大量 CLOSE_WAIT 状态的原因</h4>
<ul>
<li>对方关闭 socket 连接，我方忙于读与写，没有及时关闭连接</li>
<li>检查代码，特别是释放资源的代码</li>
<li>检查配置，特别是处理请求的线程配置</li>
</ul>
<h2 id="tcp-和-udp-区别">TCP 和 UDP 区别</h2>
<h3 id="udp-简介">UDP 简介</h3>
<ul>
<li>面向非连接</li>
<li>不维护连接状态，支持同时向多个客户端传输相同的消息</li>
<li>数据包报头只有 8 哥字节，额外开销小</li>
<li>吞吐量之受限于数据生成速率、传输速率以及机器性能</li>
<li>尽最大努力交付，不保证可靠交付，不需要维持复杂的链接状态表</li>
<li>面向报文，不对应用程序提交的信息进行拆分或者合并</li>
</ul>
<h3 id="tcp-和-udp-的区别">TCP 和 UDP 的区别</h3>
<ul>
<li>面向连接 VS 无连接（适用于多端发布）</li>
<li>可靠性</li>
<li>有序性</li>
<li>速度</li>
<li>量级</li>
</ul>
<h2 id="tcp-的滑动窗口">TCP 的滑动窗口</h2>
<p>TCP 使用滑动窗口做流量控制与乱序重排</p>
<ul>
<li>保证 TCP 的可靠性</li>
<li>保证 TCP 的流控特性</li>
</ul>
<h3 id="rtt-和-rto">RTT 和 RTO</h3>
<ul>
<li>RTT 发送一个数据包到收到对应的 ACK，所花费的时间</li>
<li>RTO 发送时间间隔（根据 RTT 计算）</li>
</ul>
<h2 id="http-与-https">HTTP 与 HTTPS</h2>
<h3 id="http-特点">http 特点</h3>
<ul>
<li>支持客户/服务器模式</li>
<li>简单快速</li>
<li>灵活</li>
<li>无连接（即使 http1.1 的 keep-live 机制，属于 http 之外的，始终认为请求结束后关闭连接，下层实现对上层透明）</li>
<li>无状态</li>
</ul>
<h3 id="http-响应步骤">http 响应步骤</h3>
<ul>
<li>客户端连接到 Web 服务器</li>
<li>发送 http 请求</li>
<li>服务器接收请求并返回 HTTP 响应</li>
<li>释放连接 TCP 连接</li>
<li>客户端浏览器解析 HTML 内容</li>
</ul>
<h3 id="在浏览器地址栏键入-url-回车流程">在浏览器地址栏键入 URL 回车流程</h3>
<ul>
<li>DNS 解析</li>
<li>TCP 连接</li>
<li>发送 HTTP 请求</li>
<li>服务器处理请求并返回 HTTP 报文</li>
<li>浏览器解析渲染页面</li>
<li>连接结束</li>
</ul>
<h3 id="常见-http-状态码">常见 HTTP 状态码</h3>
<ul>
<li>1XX 指示信息：表示请求已接受，继续处理</li>
<li>2XX 成功：表示请求已被成功接收、理解、接受</li>
<li>3XX 重定向：要完成请求必须进行更进一步的操作</li>
<li>4XX 客户端错误：请求用语法错误或请求无法实现</li>
<li>5XX 服务器端错误：服务器未能实现合法的请求</li>
</ul>
<h3 id="get-和-post-请求的区别">GET 和 POST 请求的区别</h3>
<ul>
<li>HTTP 报文层面：GET 请求信息放在 URL，POST 放在报文体中</li>
<li>数据库层面：GET 符合幂等性和安全性，POST 不符合</li>
<li>其他层面：GET 可以被缓存、被存储，而 POST 不行</li>
</ul>
<h3 id="cookue-和-session-的区别">Cookue 和 Session 的区别</h3>
<ul>
<li>Cookie 数据存放在客户的浏览器上、Seession 数据放在服务器上</li>
<li>Session 相对于 Cookie 更安全</li>
<li>若考虑减轻服务器开销，应当考虑 Cookie</li>
</ul>
<h3 id="http-和-https-的区别">HTTP 和 HTTPS 的区别</h3>
<p>SSL（TLS） 安全套接层</p>
<ul>
<li>HTTPS 需要到 CA 申请证书，HTTP 不需要</li>
<li>HTTPS 密文传输，HTTP 明文传输</li>
<li>连接方式不同，HTTPS 默认使用 443 端口，HTTP 使用 80 端口</li>
<li>HTTPS=HTTP+加密+认证+完整性保护，较安全</li>
</ul>
<h3 id="https-并不绝对安全">HTTPS 并不绝对安全</h3>
<ul>
<li>浏览器默认填充 http://，请求需要进行跳转，有被劫持的风险</li>
<li>可以使用 HSTS 优化</li>
</ul>



  <footer>
  
  

  
  <hr>
  <div class="copyright">© <a href="https://mingzaily.com">mingzaily</a> 2019-2024 | <a href="https://github.com/mingzaily">Github</a></div>
  
  </footer>
  </article>
  
  </body>
</html>

